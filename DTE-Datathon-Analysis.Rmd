---
title: "Rural Urban dynamics (DTE Datathon)"
author: "Group 7"
date: "2023-09-26"
output:
  pdf_document: default
  word_document: default
  
header-includes:
- \usepackage{fancyhdr}
- \usepackage{xcolor}
- \usepackage{sectsty}
- \sectionfont{\color[RGB]{21,97,109}}
- \subsectionfont{\color[RGB]{255,125,0}}
- \subsubsectionfont{\color[RGB]{255,236,209}}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,warning =F,message = F,comment = NA)
```

# Introduction

This analysis is intended for the DTE datathon, which aims to cultivate a data-driven, innovative, and collaborative environment for creatively addressing societal issues and producing actionable solutions.

```{r}

library(tidyverse)
library(gridExtra)
library(readxl)
library(reshape2)
library(janitor)
library(ggthemes)
library(leaflet)
library(sf)
library(ggplot2)
library(knitr)
# library(kableExtra)

df <- data.frame(
  Details = c("Time Frame","Deadline","Software/Tools"),
  values  = c("1 Week","28th September","R - studio")
)
df %>% kable(caption = "The rules of the datathon")
```


> `The objective:` The objective of this challenge is to analyze open data sets in Kenya using
real-world data. You are therefore to explore, visualize, and draw insights from the
provided dataset to provide better insights to different stakeholders on how
urbanization is impacting different aspects of Kenyan society. Participants should work
in teams and are encouraged to utilize technologies such as big data, machine learning,
and artificial Intelligence that train test, and evaluate multiple data sets to uncover
innovative solutions.



```{r}

colors <- c('#BC5308', '#FFECD1', '#C5CAB8', '#FF7D00', '#8AA79F', '#FFB569', '#15616D', '#001524')

df <- read_excel("Dataset/Dataset.xlsx")
kenya <- df
kenya1 <- df
df %>% select(1:7) %>% head() %>% knitr::kable(caption = "A sample of the data")
```


## data

As per the rules, we sourced the data from KNBS on the following website: [KNBS Data](https://knbs.or.ke/data-tables/?cp=2).

Additionally, we obtained supplementary data from the following website: [Kenya County Fact Sheets Report (PDF)](https://cra.go.ke/wp-content/uploads/2022/06/Kenya-County-fact-sheets-Report-Final-Res.pdf).

The collected data encompasses a wide range of aspects of Kenyan life, including population, GDP, infrastructure, education, healthcare, and employment.


# data sourcing and cleaning

The data collection process was primarily manual, and it followed the following general steps:

1. **Data Compilation:** We collaborated in Google Sheets to collect various data points simultaneously, gradually building up the dataset we needed.

2. **Data Cleaning:** We employed a manual query system to identify and address any anomalies or outliers in the dataset. This process involved thorough cross-checking to ensure data accuracy.

3. **Feature Engineering:** We created additional columns in the dataset, such as:

   - Total Population: $totalPopulation = femalePopulation + malePopulation$
   
   - Urban-Rural Classification: $urbanRural = \frac{urbanPopulation}{totalPopulation}$

   Based on the urban-rural classification, we categorized certain counties as either rural or urban. Counties were classified as fully urban if the urban population exceeded 40% of the total population.


## Rural-Urban population dynamics

## Rural-Urban health dynamics

### Population distribution 

```{r}
data<-read_excel("Dataset.xlsx",sheet="population distribution")

data$Cohorts<-as.factor(data$Cohorts)
data$Cohorts<-ifelse(data$Cohorts=="0-5","0-5",
                     ifelse(data$Cohorts=="45091","6-14",
                            ifelse(data$Cohorts=="15-35","15-35",
                                   ifelse(data$Cohorts=="36-60","36-60","61+"))))
data$Cohorts <- factor(data$Cohorts, levels = c("0-5", "6-14", "15-35", "36-60", "61+"))
library(ggplot2)

# Create a histogram of age cohort distribution
ggplot(data, aes(x = Cohorts, y = Total)) +
  geom_bar(stat = "identity", fill = '#15616D') +
  # geom_text(aes(label = Total)) +
  labs(x = "Age group ", y = "Population", title = "Age  Distribution for the Entire Country") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

```

Persons aged 15 to 35 years are majority indicating the high labour force and the least population in the country are those above 60 years.


## The distribution of age groups in each county

```{r, fig.height=6,fig.width=8}
cohort_summary <- data %>%
  group_by(County,Cohorts) %>%
  summarise(Total_Population = round((sum(Total)/100000),3))

# Create the bar graph
ggplot(cohort_summary, aes(x = reorder(County, -Total_Population), y = Total_Population, fill = Cohorts)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(x = "County", y = "Total Population '00000'", title = "Population by Cohorts Across Counties '00000'") +
  scale_fill_discrete() +
  theme_minimal() +
  scale_fill_manual(values = colors) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) 
```



 Majority of the counties had a population less than one million across all the age groups


## Population distribution for each county by each gender


```{r, fig.height=10,fig.width=12}



data_long <- data %>%
  pivot_longer(cols = -c("County", "Cohorts", "Total", "male", "female"), names_to = "gender", values_to = "population")

# Calculate Total population per County
total_population <- data_long %>%
  group_by(County) %>%
  summarise(Total_Population = sum(population))

# Reorder the levels of County based on Total population (descending order)
data_long$County <- factor(data_long$County, levels = total_population$County[order(-total_population$Total_Population)])

data_long %>%
  group_by(County, gender) %>%
  summarise(Totals = round((sum(population) / 100000), 2)) %>%
  ggplot(aes(x = County, y = Totals, fill = gender)) +
  geom_bar(stat = "identity") +
  geom_text(aes(label = Totals), position = position_stack(vjust = 0.5), size = 3) +
  labs(y = "Population '00000'", x = "County", title = "Gender Distribution by County in '00000'") +
  scale_fill_manual(values = c("Female" = '#FFECD1', "Male" = '#15616D')) +
  theme_minimal() +
  coord_flip() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.5))


```

Nairobi county has the highest population by both gender levels and Lamu county has the lowest population with more males than females.


### Gender distribution across the age groups in the population.


```{r, fig.height=6,fig.width=8}
# Assuming you have already loaded and transformed your data into 'data_long' as described in your code

data_long %>%
  group_by( Cohorts, gender) %>%
  summarise(Totals = round((sum(population) / 100000), 2)) %>%
  ggplot(aes(x = Cohorts, y = Totals, fill = gender)) +
  geom_bar(stat = "identity", position = "dodge") +
  geom_text(aes(label = Totals), position = position_dodge(width = 0.9), size = 3, vjust = -0.5) +
  labs(y = "Population", x = "Age groups", title = "Gender Distribution by  Age Group in '00000'") +
  scale_fill_manual(values = c("Female" = '#FFECD1', "Male" = '#15616D')) +
  theme_minimal() +
  
  theme(axis.text.x = element_text(angle = 45, hjust = 0.5))

  
```

  
  
  Female gender in the population were more in age groups 15to 35 years and above 60 years while contrast to male gender in the other age groups.
  
  
```{r}


# Load the shapefile
kenya_counties <- st_read("LYNN ANALYSIS/County.shp")
# Merge data by county
merged_data <- merge(kenya_counties, kenya, by.x = "COUNTY", by.y = "COUNTY")


```
```{r}
# Create a leaflet map
#install.packages("leaflet")
#remotes::install_github("rstudio/webshot2")
library(leaflet)
library(webshot2)
kenya_map <- leaflet(merged_data) %>%
  addProviderTiles("CartoDB.Positron") %>%
  addPolygons(
    fillColor = ~colorQuantile("YlOrRd", merged_data$`Total Population`)(merged_data$`Total Population`),
    fillOpacity = 0.7,
    color = "white",
    weight = 1,
    label = ~paste(merged_data$COUNTY, "<br>", "Total Population:", merged_data$`Total Population`, "people"),
    highlight = highlightOptions(
      weight = 3,
      color = "#666",
      fillOpacity = 0.7,
      bringToFront = TRUE
    ),
    labelOptions = labelOptions(
      style = list("font-weight" = "normal", padding = "3px 8px"),
      textsize = "15px"
    )
  ) %>%
  addLegend(
    "bottomright",
    pal = colorQuantile("YlOrRd", merged_data$`Total Population`),
    values = ~merged_data$`Total Population`,
    title = "Total population",
    opacity = 0.7
  )

# Display the map
htmlwidgets::saveWidget(kenya_map, "kenya_map.html")

# Take a screenshot and save it as an image
webshot2::webshot("kenya_map.html", "kenya_map.png")
```

#Health Analysis


```{r}

# Filter and summarize the data to count level 5/6 hospitals by county
level_5_6_hospitals <- kenya %>%
  filter(`Health_LV5/6` > 0)%>%
  select(COUNTY, `Health_LV5/6`)
  #group_by(COUNTY) %>%
  #summarise(Count_Level_5_6_Hospitals = sum(Health_LV5/6))

# Create a table using kable
#kable(level_5_6_hospitals, caption = "Count of Level 5/6 Hospitals by County")
```


```{r,fig.height=12,fig.width=10}
# Load the required libraries


# Filter the data to include only rural counties
kenya_rural <- kenya %>%
  filter(Status == "Rural") %>%
  arrange(Health_LV4)

# Create the bar chart
fig1<- ggplot(kenya_rural, aes(x = reorder(COUNTY, -Health_LV4), y = Health_LV4, fill = "#BC5308")) +
  geom_bar(stat = "identity", show.legend = FALSE) +
  theme_minimal() +
  labs(x = "County", y = "Number of Level 4 Hospitals") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_fill_discrete(name = "County") +
  ggtitle("Distribution of Level 4 Hospitals by Rural Counties") +
  coord_flip()+
  scale_fill_manual(values = colors)

```

```{r,fig.height=12,fig.width=10}
# Filter the data to include only rural counties
kenya_rural <- kenya %>%
  filter(Status == "Urban") %>%
  arrange(Health_LV4)

# Create the bar chart
fig2<-ggplot(kenya_rural, aes(x = reorder(COUNTY, -Health_LV4), y = Health_LV4)) +
  geom_bar(stat = "identity", show.legend = FALSE,fill=colors[7]) +
  theme_minimal() +
  labs(x = "County", y = "Number of Level 4 Hospitals") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_fill_discrete(name = "County") +
  ggtitle("Distribution of Level 4 Hospitals by Urban Counties") +
  coord_flip()+
  scale_fill_manual(values = colors)

```

```{r,fig.height=12,fig.width=10}
# Filter the data to include only rural counties
kenya_rural <- kenya %>%
  filter(Status == "Rural") %>%
  arrange(Health_LV3)

# Create the bar chart
fig3<-ggplot(kenya_rural, aes(x = reorder(COUNTY, -Health_LV3), y = Health_LV3, fill = "#BC5308")) +
  geom_bar(stat = "identity", show.legend = FALSE) +
  theme_minimal() +
  labs(x = "County", y = "Number of Level 3 Hospitals") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_fill_discrete(name = "County") +
  ggtitle("Distribution of Level 3 Hospitals by Rural Counties") +
  coord_flip()+
  scale_fill_manual(values = colors)

```

```{r,fig.height=12,fig.width=10}
# Filter the data to include only rural counties
kenya_rural <- kenya %>%
  filter(Status == "Urban") %>%
  arrange(Health_LV3)

# Create the bar chart
fig4<-ggplot(kenya_rural, aes(x = reorder(COUNTY, -Health_LV3), y = Health_LV3)) +
  geom_bar(stat = "identity", show.legend = FALSE,fill=colors[7]) +
  theme_minimal() +
  labs(x = "County", y = "Number of Level 3 Hospitals") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_fill_discrete(name = "County") +
  ggtitle("Distribution of Level 3 Hospitals by Urban Counties") +
  coord_flip()+
  scale_fill_manual(values = colors)

```


```{r,fig.height=12,fig.width=10}
kenya_rural<-kenya%>%
  filter(Status=="Rural")%>%
  arrange(Health_LV2)

#create bar chart
fig5<-ggplot(kenya, aes(x = reorder(COUNTY, -Health_LV2), y = Health_LV2, fill = "#15616D")) +
  geom_bar(stat = "identity",show.legend = FALSE) +
  theme_minimal() +
  labs(x = "County", y = "Number of Level 2 Hospitals") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_fill_discrete(name = "County") +
  ggtitle("Distribution of Level 2 Hospitals by Rural Counties")+
  coord_flip()+
  scale_fill_manual(values = colors)

```

```{r,fig.height=12,fig.width=10}
kenya_rural<-kenya%>%
  filter(Status=="Urban")%>%
  arrange(Health_LV2)

#create bar chart
fig6<-ggplot(kenya_rural, aes(x = reorder(COUNTY, -Health_LV2), y = Health_LV2)) +
  geom_bar(stat = "identity",show.legend = FALSE,fill=colors[7]) +
  theme_minimal() +
  labs(x = "County", y = "Number of Level 2 Hospitals") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_fill_discrete(name = "County") +
  ggtitle("Distribution of Level 2 Hospitals by Urban Counties")+
  coord_flip()+
  scale_fill_manual(values = colors)

```

```{r,fig.height=12,fig.width=10}
kenya_rural<-kenya%>%
  filter(Status=="Rural")%>%
  arrange(`Bed density per 10000 ppn`)

#create bar chart
fig7<-ggplot(kenya_rural, aes(x = reorder(COUNTY, -`Bed density per 10000 ppn`), y = `Bed density per 10000 ppn`,
                              fill="#15616D")) +
  geom_bar(stat = "identity",show.legend = FALSE) +
  theme_minimal() +
  labs(x = "County", y = "Bed density per 10000 ppn") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_fill_discrete(name = "County") +
  ggtitle("Distribution of Bed density per 10000 ppn by Rural Counties")+
  coord_flip()+
  scale_fill_manual(values = colors)

```

```{r,fig.height=12,fig.width=10}
kenya_rural<-kenya%>%
  filter(Status=="Urban")%>%
  arrange(`Bed density per 10000 ppn`)

#create bar chart
fig8<-ggplot(kenya_rural, aes(x = reorder(COUNTY, -`Bed density per 10000 ppn`), y = `Bed density per 10000 ppn`)) +
  geom_bar(stat = "identity",show.legend = FALSE,fill=colors[7]) +
  theme_minimal() +
  labs(x = "County", y = "Bed density per 10000 ppn") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_fill_discrete(name = "County") +
  ggtitle("Distribution of Bed density per 10000 ppn by Urban Counties")+
  coord_flip()+
  scale_fill_manual(values = colors)

```

```{r,fig.height=12,fig.width=10}
kenya_rural<-kenya%>%
  filter(Status=="Rural")%>%
  arrange(`Health worker per 10000 ppn`)

#create bar chart
fig9<-ggplot(kenya_rural, aes(x = reorder(COUNTY, -`Health worker per 10000 ppn`), y = `Health worker per 10000 ppn`,
                              fill="#15616D")) +
  geom_bar(stat = "identity",show.legend = FALSE) +
  theme_minimal() +
  labs(x = "County", y = "Health worker per 10000 ppn") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_fill_discrete(name = "County") +
  ggtitle("Distribution of Health worker per 10000 ppn by Urban Counties")+
  coord_flip()+
  scale_fill_manual(values = colors)
```

```{r,fig.height=12,fig.width=10}
kenya_rural<-kenya%>%
  filter(Status=="Urban")%>%
  arrange(`Health worker per 10000 ppn`)

#create bar chart
fig10<-ggplot(kenya_rural, aes(x = reorder(COUNTY, -`Health worker per 10000 ppn`), y = `Health worker per 10000 ppn`)) +
  geom_bar(stat = "identity",show.legend = FALSE,fill=colors[7]) +
  theme_minimal() +
  labs(x = "County", y = "Health worker per 10000 ppn") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_fill_discrete(name = "County") +
  ggtitle("Distribution of Health worker per 10000 ppn by Urban Counties")+
  coord_flip()+
  scale_fill_manual(values = colors)
```

## Bar charts showing Level 4 Hospital Distribution by counties

```{r,fig.height=10,fig.width=8}
library(gridExtra)
grid.arrange(fig1,fig2,ncol=1)
```

## Bar charts showing Level 3 Hospital Distribution by counties

```{r,fig.height=10,fig.width=8}
grid.arrange(fig3,fig4,ncol=1)
```

## Bar charts showing Level 2 Hospital Distribution by counties

```{r,fig.height=10,fig.width=8}
grid.arrange(fig5,fig6,ncol=1)
```

## Bar charts showing Hospital Bed density per 10000 population by counties

```{r,fig.height=10,fig.width=8}
grid.arrange(fig7,fig8,ncol=1)
```

## Barcharts showing Hospital worker per 10000 population Distribution by counties

```{r,fig.height=10,fig.width=8}
grid.arrange(fig9,fig10,ncol=1)
```

# Rural-Urban Education dynamics
## Primary school education

```{r,fig.width = 12,fig.height =12}
# find an arrangement index
y <- df %>%  select(County,`Ppn with primary(%)`,Status) %>% arrange(`Ppn with primary(%)`)
y$County <- factor(y$County,levels = y$County)

# create a graph for urban
rural <- y %>% filter(Status == 'Rural') %>% mutate(perc = paste(`Ppn with primary(%)`,'%')) %>% 
  ggplot(aes(x = County,y  =`Ppn with primary(%)`,label = perc))+geom_bar(stat = 'identity',fill = colors[7],show.legend = FALSE)+coord_flip()+
  #scale_fill_manual(values = c(colors[1],colors[7]))+
  labs(title = "Population with and without primary education\n (Rural Areas)")+scale_y_continuous(labels = scales::percent_format(scale = 1))+
  geom_text(aes(y = `Ppn with primary(%)` - 2, color = colors[2]), size = 3, position = position_dodge(width = 0.9),show.legend = FALSE)+theme(
    plot.title = element_text(hjust = 0.7)  # Center the title
  )+
  theme_hc()

# create a graph for urban
urban <- y %>% filter(Status == 'Urban') %>% mutate(perc = paste(`Ppn with primary(%)`,'%')) %>% 
  ggplot(aes(x = County,y  =`Ppn with primary(%)`,label = perc))+geom_bar(stat = 'identity',fill = colors[7],show.legend = FALSE)+coord_flip()+
  #scale_fill_manual(values = c(colors[1],colors[7]))+
  labs(title = "Population with and without primary education\n (Urban Areas)")+scale_y_continuous(labels = scales::percent_format(scale = 1))+
  geom_text(aes(y = `Ppn with primary(%)` - 2, color = colors[2]), size = 3, position = position_dodge(width = 0.9),show.legend = FALSE)+theme(
    plot.title = element_text(hjust = 0.7)  # Center the title
  )+
  theme_hc()
grid.arrange(rural,urban,ncol =2)

```

## Secondary school education

```{r,fig.width = 12,fig.height =12}
# find an arrangement index
y <- df %>%  select(County,`Ppn with secondary%`,Status) %>% arrange(`Ppn with secondary%`)
y$County <- factor(y$County,levels = y$County)



# create a graph for urban
rural <- y %>% filter(Status == 'Rural') %>% mutate(perc = paste(`Ppn with secondary%`,'%')) %>% 
  ggplot(aes(x = County,y  =`Ppn with secondary%`,label = perc))+geom_bar(stat = 'identity',fill = colors[7],show.legend = FALSE)+coord_flip()+
  #scale_fill_manual(values = c(colors[1],colors[7]))+
  labs(title = "Population with and without secondary education\n (Rural Areas)")+scale_y_continuous(labels = scales::percent_format(scale = 1))+
  geom_text(aes(y = `Ppn with secondary%` - 2, color = colors[2]), size = 3, position = position_dodge(width = 0.9),show.legend = FALSE)+theme(
    plot.title = element_text(hjust = 0.7)  # Center the title
  )+
  theme_hc()

# create a graph for urban
urban <- y %>% filter(Status == 'Urban') %>% mutate(perc = paste(`Ppn with secondary%`,'%')) %>% 
  ggplot(aes(x = County,y  =`Ppn with secondary%`,label = perc))+geom_bar(stat = 'identity',fill = colors[7],show.legend = FALSE)+coord_flip()+
  #scale_fill_manual(values = c(colors[1],colors[7]))+
  labs(title = "Population with and without secondary education\n (Urban Areas)")+scale_y_continuous(labels = scales::percent_format(scale = 1))+
  geom_text(aes(y = `Ppn with secondary%` - 2, color = colors[2]), size = 3, position = position_dodge(width = 0.9),show.legend = FALSE)+theme(
    plot.title = element_text(hjust = 0.7)  # Center the title
  )+
  theme_hc()
grid.arrange(rural,urban,ncol =2)

```

```{r}
df %>% select(Status,`No Primary`,`Number secondary`) %>% 
  melt(id.vars = 'Status') %>% 
  ggplot(aes(x = variable,y =value,fill = Status))+geom_boxplot(width = 0.3, size = 0.7)+
  theme_hc()+
  labs(title = "Number of primary and secondary schools per county \n(rural vs urban )")+
  theme(
    plot.title = element_text(hjust = 0.5)  # Center the title
  )+
  scale_fill_manual(values = c(colors[1],colors[7]))
```




## Rural-Urban Misc


```{r fig.width=12,fig.height=8}
water_county <-kenya1 %>% 
  filter(Status== "Rural") %>% 
  select("County","Status","Households with water %")

fig1<- ggplot(water_county, aes(x = reorder(County, -`Households with water %`), y = `Households with water %`, fill = Status))+
  geom_bar(stat = "identity", position = "dodge",show.legend = FALSE, fill = '#15616D') +
  geom_text(aes(label = `Households with water %`), vjust = -0.5,hjust =0.5, size = 3)+
  labs(title = "Percentage of Households with Water by County",
       x = "County",
       y = "Percentage of Households with Water") +
  theme_minimal()+
  coord_flip()+
   theme(panel.grid = element_blank())
```


```{r fig.width=12,fig.height=8}
water_county <-kenya1 %>% 
  filter(Status== "Urban") %>% 
  select("County","Status","Households with water %")

fig2<- ggplot(water_county, aes(x = reorder(County, -`Households with water %`), y = `Households with water %`, fill = Status))+
  geom_bar(stat = "identity", position = "dodge",show.legend = FALSE,fill = '#BC5308') +
  geom_text(aes(label = `Households with water %`), vjust = -0.5,hjust =0.5, size = 3)+
  labs(title = "Percentage of Households with Water by County",
       x = "County",
       y = "Percentage of Households with Water") +
  theme_minimal()+
  coord_flip()+
  theme(panel.grid = element_blank())
```


```{r fig.width=12,fig.height=8}

grid.arrange(fig1,fig2,ncol=1)
```

```{r}
# water_county
```


```{r fig.width=12,fig.height=8}
Electricity_county<-kenya1 %>% 
  filter(Status=="Rural") %>% 
  select("County","Status","Household with Electricity %") %>% 
  arrange(`Household with Electricity %`)
fig3<-ggplot(Electricity_county, aes(x = reorder(County, -`Household with Electricity %`), y = `Household with Electricity %`, fill = Status))+
  geom_bar(stat = "identity", position = "dodge",show.legend = FALSE, fill= '#15616D') +
  geom_text(aes(label = `Household with Electricity %`), vjust = -0.5,hjust =0.5, size = 3)+
  labs(title = "Households accessing Electricity %",
       x = "County",
       y = "Electricity coverage%") +
  theme_minimal()+
  coord_flip()+
   theme(panel.grid = element_blank())
```


```{r fig.width=12,fig.height=8}
Electricity_county<-kenya1 %>% 
  filter(Status=="Urban") %>% 
  select("County","Status","Household with Electricity %") %>% 
  arrange(`Household with Electricity %`)
fig4<-ggplot(Electricity_county, aes(x = reorder(County, -`Household with Electricity %`), y = `Household with Electricity %`, fill = Status))+
  geom_bar(stat = "identity", position = "dodge",show.legend = FALSE,fill= '#BC5308') +
  geom_text(aes(label = `Household with Electricity %`), vjust = -0.5,hjust =0.5, size = 5)+
  labs(title = "Households accessing Electricity %",
       x = "County",
       y = "Electricity coverage%") +
  theme_minimal()+
  coord_flip()+
   theme(panel.grid = element_blank())
```


```{r fig.width=12,fig.height=8}
grid.arrange(fig3,fig4,ncol=1)
```

```{r fig.width=12,fig.height=8}
Rural_index_county<-kenya1 %>%
  filter(Status=="Rural") %>% 
  select("County","Status","Rural Access Index%") 

fig5<- ggplot(Rural_index_county, aes(x = reorder(County,-`Rural Access Index%`), y = `Rural Access Index%`, fill = Status))+
  geom_bar(stat = "identity", position = "dodge",show.legend = FALSE,fill ='#15616D') +
  geom_text(aes(label = `Rural Access Index%`), vjust = -0.5,hjust =0.5, size = 5)+
  labs(title = "Rural access Index (RAI) %",
       x = "County",
       y = "percentage (%)") +
  theme_minimal()+
  scale_fill_manual(values = colors)+
  coord_flip()+
  theme(panel.grid = element_blank())
```


```{r fig.width=12,fig.height=8}
Rural_index_county<-kenya1 %>%
  filter(Status=="Urban") %>% 
  select("County","Status","Rural Access Index%") 

fig6<- ggplot(Rural_index_county, aes(x = reorder(County,-`Rural Access Index%`), y = `Rural Access Index%`, fill = Status))+
  geom_bar(stat = "identity", position = "dodge",show.legend = FALSE, fill = '#BC5308') +
  geom_text(aes(label = `Rural Access Index%`), vjust = -0.5,hjust =0.5, size = 5)+
  labs(title = "Rural access Index (RAI) %",
       x = "County",
       y = "percentage (%)") +
  theme_minimal()+
  scale_fill_manual(values = colors)+
  coord_flip()+
  theme(panel.grid = element_blank())
```


```{r fig.width=12,fig.height=8}
grid.arrange(fig5,fig6,ncol=1)
```


```{r fig.width=12,fig.height=8}
Internet_county<-kenya1 %>% 
  filter(Status =="Rural") %>% 
  select("County","Status","population accessing internet%") 

fig7<- ggplot(Internet_county, aes(x = reorder(County,-`population accessing internet%`), y = `population accessing internet%`, fill = Status))+
  geom_bar(stat = "identity", position = "dodge",show.legend = FALSE, fill = '#15616D') +
  geom_text(aes(label = `population accessing internet%`), vjust = -0.5,hjust =0.5, size = 3)+
  labs(title = "Population accessing Internet%",
       x = "County",
       y = "percentage (%)") +
  theme_minimal()+
  scale_fill_manual(values = colors)+
  coord_flip()+
  theme(panel.grid = element_blank())
```


```{r fig.width=12,fig.height=8}
Internet_county<-kenya1 %>% 
  filter(Status =="Urban") %>% 
  select("County","Status","population accessing internet%") 

fig8<-ggplot(Internet_county, aes(x = reorder(County,-`population accessing internet%`), y = `population accessing internet%`, fill = Status))+
  geom_bar(stat = "identity", position = "dodge",show.legend = FALSE,fill = '#BC5308') +
  geom_text(aes(label = `population accessing internet%`), vjust = -0.5,hjust =0.5, size = 6)+
  labs(title = "Population accessing Internet%",
       x = "County",
       y = "percentage (%)") +
  theme_minimal()+
  scale_fill_manual(values = colors)+
  coord_flip()+
  theme(panel.grid = element_blank())
```


```{r fig.width=12,fig.height=8}
grid.arrange(fig7,fig8,ncol=1)
```


```{r fig.width=12,fig.height=8}
mobile_phones<-kenya1 %>%
  filter(Status == "Rural") %>% 
  select("County","Status","population owning mobile phones%") 

fig9<- ggplot(mobile_phones, aes(x = reorder(County, -`population owning mobile phones%`), y = `population owning mobile phones%`, fill = Status))+
  geom_bar(stat = "identity", position = "dodge",show.legend = FALSE, fill ='#15616D') +
  geom_text(aes(label = `population owning mobile phones%`), vjust = -0.5,hjust =0.5, size = 3)+
  labs(title = "Population owning mobile phones%",
       x = "County",
       y = "percentage (%)") +
  theme_minimal()+
  scale_fill_manual(values = colors)+
  coord_flip()+theme(panel.grid = element_blank())
```


```{r fig.width=12,fig.height=8}
mobile_phones<-kenya1 %>%
  filter(Status == "Urban") %>% 
  select("County","Status","population owning mobile phones%") 

fig10<- ggplot(mobile_phones, aes(x = reorder(County, -`population owning mobile phones%`), y = `population owning mobile phones%`, fill = Status))+
  geom_bar(stat = "identity", position = "dodge",show.legend = FALSE, fill = '#BC5308') +
  geom_text(aes(label = `population owning mobile phones%`), vjust = -0.5,hjust =0.5, size = 5)+
  labs(title = "Population owning mobile phones%",
       x = "County",
       y = "percentage (%)") +
  theme_minimal()+
  scale_fill_manual(values = colors)+
  coord_flip()+theme(panel.grid = element_blank())

```

```{r}
library(gridExtra)
grid.arrange(fig9,fig10,ncol=1)

```

# findings and conclusion

