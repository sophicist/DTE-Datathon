<<<<<<< HEAD
df
colors <- c('#BC5308', '#FFECD1', '#C5CAB8', '#FF7D00', '#8AA79F', '#FFB569', '#15616D', '#001524')
df <- read_excel("Dataset/Dataset.xlsx", sheet = "data")
kenya <- df
kenya1 <- df
df %>% select(1:7) %>% head() %>% knitr::kable(caption = "A sample of the data")
library(tidyverse)
library(gridExtra)
library(readxl)
library(reshape2)
library(janitor)
library(ggthemes)
library(leaflet)
library(dplyr)
library(sf)
library(ggplot2)
library(knitr)
# library(kableExtra)
df <- data.frame(
Details = c("Time Frame","Deadline","Software/Tools"),
values  = c("1 Week","28th September","R - studio")
)
df %>% kable(caption = "The rules of the datathon")
knitr::opts_chunk$set(echo = TRUE,warning =F,message = F,comment = NA)
library(tidyverse)
library(gridExtra)
library(readxl)
library(reshape2)
library(janitor)
library(ggthemes)
library(leaflet)
library(dplyr)
library(sf)
library(ggplot2)
library(knitr)
# library(kableExtra)
df <- data.frame(
Details = c("Time Frame","Deadline","Software/Tools"),
values  = c("1 Week","28th September","R - studio")
)
df %>% kable(caption = "The rules of the datathon")
colors <- c('#BC5308', '#FFECD1', '#C5CAB8', '#FF7D00', '#8AA79F', '#FFB569', '#15616D', '#001524')
df <- read_excel("Dataset/Dataset.xlsx", sheet = "data")
kenya <- df
kenya1 <- df
df %>% select(1:7) %>% head() %>% knitr::kable(caption = "A sample of the data")
data<-read_excel("Dataset.xlsx",sheet="population distribution")
data$Cohorts<-as.factor(data$Cohorts)
data$Cohorts<-ifelse(data$Cohorts=="0-5","0-5",
ifelse(data$Cohorts=="45091","6-14",
ifelse(data$Cohorts=="15-35","15-35",
ifelse(data$Cohorts=="36-60","36-60","61+"))))
data$Cohorts <- factor(data$Cohorts, levels = c("0-5", "6-14", "15-35", "36-60", "61+"))
library(ggplot2)
# Create a histogram of age cohort distribution
ggplot(data, aes(x = Cohorts, y = Total)) +
geom_bar(stat = "identity", fill = '#15616D') +
# geom_text(aes(label = Total)) +
labs(x = "Age group ", y = "Population", title = "Age  Distribution for the Entire Country") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
cohort_summary <- data %>%
group_by(County,Cohorts) %>%
summarise(Total_Population = round((sum(Total)/100000),3))
# Create the bar graph
ggplot(cohort_summary, aes(x = reorder(County, -Total_Population), y = Total_Population, fill = Cohorts)) +
geom_bar(stat = "identity", position = "dodge") +
labs(x = "County", y = "Total Population '00000'", title = "Population by Cohorts Across Counties '00000'") +
scale_fill_discrete() +
theme_minimal() +
scale_fill_manual(values = colors) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
data_long <- data %>%
pivot_longer(cols = -c("County", "Cohorts", "Total"), names_to = "gender", values_to = "population")
# Calculate Total population per County
total_population <- data_long %>%
group_by(County) %>%
summarise(Total_Population = sum(population))
# Reorder the levels of County based on Total population (descending order)
data_long$County <- factor(data_long$County, levels = total_population$County[order(-total_population$Total_Population)])
data_long %>%
group_by(County, gender) %>%
summarise(Totals = round((sum(population) / 100000), 2)) %>%
ggplot(aes(x = County, y = Totals, fill = gender)) +
geom_bar(stat = "identity") +
geom_text(aes(label = Totals), position = position_stack(vjust = 0.5), size = 3) +
labs(y = "Population '00000'", x = "County", title = "Gender Distribution by County in '00000'") +
scale_fill_manual(values = c("Female" = '#FFECD1', "Male" = '#15616D')) +
theme_minimal() +
coord_flip() +
theme(axis.text.x = element_text(angle = 45, hjust = 0.5))
# Assuming you have already loaded and transformed your data into 'data_long' as described in your code
data_long %>%
group_by( Cohorts, gender) %>%
summarise(Totals = round((sum(population) / 100000), 2)) %>%
ggplot(aes(x = Cohorts, y = Totals, fill = gender)) +
geom_bar(stat = "identity", position = "dodge") +
geom_text(aes(label = Totals), position = position_dodge(width = 0.9), size = 3, vjust = -0.5) +
labs(y = "Population", x = "Age groups", title = "Gender Distribution by  Age Group in '00000'") +
scale_fill_manual(values = c("Female" = '#FFECD1', "Male" = '#15616D')) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 0.5))
df
df %>% summarise(`Rural mean population`=mean(Rural_ppn),
`Rural SD`=sd(Rural_ppn),
`Urban mean population`=mean(Urban_ppn),
`Urban SD`=sd(Urban_ppn))
df %>% summarise(`Rural mean population`=mean(Rural_ppn),
`Rural SD`=sd(Rural_ppn),
`Rural IQR`=IQR(Rural_ppn),
`Urban mean population`=mean(Urban_ppn),
`Urban SD`=sd(Urban_ppn),
`Urban IQR`=IQR(Urban_ppn))
df %>% summarise(`Rural mean population`=mean(Rural_ppn),
`Rural SD`=sd(Rural_ppn),
`Rural IQR`=IQR(Rural_ppn),
`Urban mean population`=mean(Urban_ppn),
`Urban SD`=sd(Urban_ppn),
`Urban IQR`=IQR(Urban_ppn)).t()
stats=df %>% summarise(`Rural mean population`=mean(Rural_ppn),
`Rural SD`=sd(Rural_ppn),
`Rural IQR`=IQR(Rural_ppn),
`Urban mean population`=mean(Urban_ppn),
`Urban SD`=sd(Urban_ppn),
`Urban IQR`=IQR(Urban_ppn))
stats.t()
stats
stats=df %>% summarise(`Rural mean population`=mean(Rural_ppn),
`Rural SD`=sd(Rural_ppn),
`Rural IQR`=IQR(Rural_ppn),
`Urban mean population`=mean(Urban_ppn),
`Urban SD`=sd(Urban_ppn),
`Urban IQR`=IQR(Urban_ppn))
stats %>% kable()
stats=df %>% summarise(`Rural mean population`=mean(Rural_ppn),
`Rural SD`=sd(Rural_ppn),
`Rural IQR`=IQR(Rural_ppn),
`Urban mean population`=mean(Urban_ppn),
`Urban SD`=sd(Urban_ppn),
`Urban IQR`=IQR(Urban_ppn))
stats %>% kable()
df %>% select(c(Countu,Rural_ppn,Urban_ppn))
df
df %>% select(Countu,Rural_ppn,Urban_ppn)
df %>% select(c("County","Rural_ppn","Urban_ppn"))
df %>%
select(c("County","Rural_ppn","Urban_ppn")) %>%
pivot_longer(id!="County", values_to = Populations,names_to = "Residence")
df %>%
select(County, Rural_ppn, Urban_ppn) %>%
pivot_longer(cols = c(Rural_ppn, Urban_ppn), names_to = "Residence", values_to = "Populations")
df %>%
select(County, Rural_ppn, Urban_ppn) %>%
pivot_longer(cols = c(Rural_ppn, Urban_ppn), names_to = "Residence", values_to = "Populations") %>%
ifelse(Residence=="Rural_ppn","Rural","Urban")
df %>%
select(County, Rural_ppn, Urban_ppn) %>%
pivot_longer(cols = c(Rural_ppn, Urban_ppn), names_to = "Residence", values_to = "Populations") %>%
ifelse(Residence="Rural_ppn","Rural","Urban")
DataRural=df %>%
select(County, Rural_ppn, Urban_ppn) %>%
pivot_longer(cols = c(Rural_ppn, Urban_ppn), names_to = "Residence", values_to = "Populations") %>%
knitr::opts_chunk$set(echo = TRUE,warning =F,message = F,comment = NA)
library(tidyverse)
=======
arrange(Health_LV3)
# Create the bar chart
fig4<-ggplot(kenya_rural, aes(x = reorder(COUNTY, -Health_LV3), y = Health_LV3)) +
geom_bar(stat = "identity", show.legend = FALSE,fill=colors[7]) +
theme_minimal() +
labs(x = "County", y = "Number of Level 3 Hospitals") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_fill_discrete(name = "County") +
ggtitle("Distribution of Level 3 Hospitals by Urban Counties") +
coord_flip()+
geom_text(aes(label = Health_LV3), vjust = 0.5, hjust = 1, size = 4, color = colors[1])+
theme_hc()
fig4
# Filter the data to include only rural counties
kenya_rural <- kenya %>%
filter(Status == "Urban") %>%
arrange(Health_LV3)
# Create the bar chart
fig4<-ggplot(kenya_rural, aes(x = reorder(COUNTY, -Health_LV3), y = Health_LV3)) +
geom_bar(stat = "identity", show.legend = FALSE,fill=colors[7]) +
theme_minimal() +
labs(x = "County", y = "Number of Level 3 Hospitals") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_fill_discrete(name = "County") +
ggtitle("Distribution of Level 3 Hospitals by Urban Counties") +
coord_flip()+
geom_text(aes(label = Health_LV3), vjust = 0.5, hjust = 1, size = 5, color = colors[1])+
theme_hc()
fig4
# Filter the data to include only rural counties
kenya_rural <- kenya %>%
filter(Status == "Urban") %>%
arrange(Health_LV3)
# Create the bar chart
fig4<-ggplot(kenya_rural, aes(x = reorder(COUNTY, -Health_LV3), y = Health_LV3)) +
geom_bar(stat = "identity", show.legend = FALSE,fill=colors[7]) +
theme_minimal() +
labs(x = "County", y = "Number of Level 3 Hospitals") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_fill_discrete(name = "County") +
ggtitle("Distribution of Level 3 Hospitals by Urban Counties") +
coord_flip()+
geom_text(aes(label = Health_LV3), vjust = 0.5, hjust = 1, size = 6, color = colors[1])+
theme_hc()
fig4
kenya_rural<-kenya%>%
filter(Status=="Rural")%>%
arrange(Health_LV2)
#create bar chart
fig5<-ggplot(kenya, aes(x = reorder(COUNTY, -Health_LV2), y = Health_LV2, fill = "#15616D")) +
geom_bar(stat = "identity",show.legend = FALSE) +
theme_minimal() +
labs(x = "County", y = "Number of Level 2 Hospitals") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_fill_discrete(name = "County") +
ggtitle("Distribution of Level 2 Hospitals by Rural Counties")+
coord_flip()+
geom_text(aes(label = Health_LV2), vjust = 0.5, hjust = 1, size = 6, color = colors[1])+
theme_hc()
kenya_rural<-kenya%>%
filter(Status=="Rural")%>%
arrange(Health_LV2)
#create bar chart
fig5<-ggplot(kenya, aes(x = reorder(COUNTY, -Health_LV2), y = Health_LV2, fill = colors[7])) +
geom_bar(stat = "identity",show.legend = FALSE) +
theme_minimal() +
labs(x = "County", y = "Number of Level 2 Hospitals") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_fill_discrete(name = "County") +
ggtitle("Distribution of Level 2 Hospitals by Rural Counties")+
coord_flip()+
geom_text(aes(label = Health_LV2), vjust = 0.5, hjust = 1, size = 6, color = colors[1])+
theme_hc()
fig5
kenya_rural<-kenya%>%
filter(Status=="Rural")%>%
arrange(Health_LV2)
#create bar chart
fig5<-ggplot(kenya, aes(x = reorder(COUNTY, -Health_LV2), y = Health_LV2, fill = colors[1])) +
geom_bar(stat = "identity",show.legend = FALSE) +
theme_minimal() +
labs(x = "County", y = "Number of Level 2 Hospitals") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_fill_discrete(name = "County") +
ggtitle("Distribution of Level 2 Hospitals by Rural Counties")+
coord_flip()+
geom_text(aes(label = Health_LV2), vjust = 0.5, hjust = 1, size = 6, color = colors[1])+
theme_hc()
fig5
kenya_rural<-kenya%>%
filter(Status=="Rural")%>%
arrange(Health_LV2)
#create bar chart
fig5<-ggplot(kenya, aes(x = reorder(COUNTY, -Health_LV2), y = Health_LV2, fill = colors[1])) +
geom_bar(stat = "identity",show.legend = FALSE) +
theme_minimal() +
labs(x = "County", y = "Number of Level 2 Hospitals") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_fill_discrete(name = "County") +
ggtitle("Distribution of Level 2 Hospitals by Rural Counties")+
coord_flip()+
geom_text(aes(label = Health_LV2), vjust = 0.5, hjust = 1, size = 6, color = colors[7])+
theme_hc()
fig5
kenya_rural<-kenya%>%
filter(Status=="Urban")%>%
arrange(Health_LV2)
#create bar chart
fig6<-ggplot(kenya_rural, aes(x = reorder(COUNTY, -Health_LV2), y = Health_LV2)) +
geom_bar(stat = "identity",show.legend = FALSE,fill=colors[1]) +
theme_minimal() +
labs(x = "County", y = "Number of Level 2 Hospitals") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_fill_discrete(name = "County") +
ggtitle("Distribution of Level 2 Hospitals by Urban Counties")+
coord_flip()+
geom_text(aes(label = Health_LV2), vjust = 0.5, hjust = 1, size = 6, color = colors[7])+
theme_hc()
kenya_rural<-kenya%>%
filter(Status=="Urban")%>%
arrange(Health_LV2)
#create bar chart
fig6<-ggplot(kenya_rural, aes(x = reorder(COUNTY, -Health_LV2), y = Health_LV2)) +
geom_bar(stat = "identity",show.legend = FALSE,fill=colors[1]) +
theme_minimal() +
labs(x = "County", y = "Number of Level 2 Hospitals") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_fill_discrete(name = "County") +
ggtitle("Distribution of Level 2 Hospitals by Urban Counties")+
coord_flip()+
geom_text(aes(label = Health_LV2), vjust = 0.5, hjust = 1, size = 6, color = colors[7])+
theme_hc()
fig6
kenya_rural<-kenya%>%
filter(Status=="Rural")%>%
arrange(`Bed density per 10000 ppn`)
#create bar chart
fig7<-ggplot(kenya_rural, aes(x = reorder(COUNTY, -`Bed density per 10000 ppn`), y = `Bed density per 10000 ppn`,
fill="#15616D")) +
geom_bar(stat = "identity",show.legend = FALSE) +
theme_minimal() +
labs(x = "County", y = "Bed density per 10000 ppn") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_fill_discrete(name = "County") +
ggtitle("Distribution of Bed density per 10000 ppn by Rural Counties")+
coord_flip()+
geom_text(aes(label = `Bed density per 10000 ppn`), vjust = 0.5, hjust = 1, size = 6, color = colors[1])+
theme_hc()
fig7
kenya_rural<-kenya%>%
filter(Status=="Rural")%>%
arrange(`Bed density per 10000 ppn`)
#create bar chart
fig7<-ggplot(kenya_rural, aes(x = reorder(COUNTY, -`Bed density per 10000 ppn`), y = `Bed density per 10000 ppn`,
fill=colors[7])) +
geom_bar(stat = "identity",show.legend = FALSE) +
theme_minimal() +
labs(x = "County", y = "Bed density per 10000 ppn") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_fill_discrete(name = "County") +
ggtitle("Distribution of Bed density per 10000 ppn by Rural Counties")+
coord_flip()+
geom_text(aes(label = `Bed density per 10000 ppn`), vjust = 0.5, hjust = 1, size = 6, color = colors[1])+
theme_hc()
fig7
kenya_rural<-kenya%>%
filter(Status=="Rural")%>%
arrange(`Bed density per 10000 ppn`)
#create bar chart
fig7<-ggplot(kenya_rural, aes(x = reorder(COUNTY, -`Bed density per 10000 ppn`), y = `Bed density per 10000 ppn`,
fill=colors[1])) +
geom_bar(stat = "identity",show.legend = FALSE) +
theme_minimal() +
labs(x = "County", y = "Bed density per 10000 ppn") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_fill_discrete(name = "County") +
ggtitle("Distribution of Bed density per 10000 ppn by Rural Counties")+
coord_flip()+
geom_text(aes(label = `Bed density per 10000 ppn`), vjust = 0.5, hjust = 1, size = 6, color = colors[7])+
theme_hc()
fig7
kenya_rural<-kenya%>%
filter(Status=="Rural")%>%
arrange(`Bed density per 10000 ppn`)
#create bar chart
fig7<-ggplot(kenya_rural, aes(x = reorder(COUNTY, -`Bed density per 10000 ppn`), y = `Bed density per 10000 ppn`,
fill=colors[7])) +
geom_bar(stat = "identity",show.legend = FALSE) +
theme_minimal() +
<<<<<<< HEAD
scale_x_continuous(labels = abs) +
theme(legend.position = "none")
# Create the population pyramid plot
ggplot(data, aes(x = -Female, xend = Male, y = reorder(Cohorts, -Female Male))) +
knitr::opts_chunk$set(echo = TRUE, warning = F,message = F,comment = NA)
>>>>>>> 853f74498eb8b7e5537daefca45670297b41da9d
rm(list=ls())
library(pacman)
p_load(readxl,tidyverse,dplyr,reshape2,ggplot2,plotly)
DataRural<-read_excel("Data/Rural-population-households-density-by-county.xlsx")
DataUrban<-read_excel("Data/Urban-population-households-density-by-county.xlsx")
DataRural['place']<-"Rural"
DataUrban['place']<-"Urban"
DataUrbanGender<-read_excel("Data/Population-in-urban-centers-by-sex-and-urban-center.xlsx")
DataFinal<-rbind(DataRural,DataUrban)
<<<<<<< HEAD
DataFinal
write.csv(DataFinal,"data.csv")
=======
library(googlesheets4)
gs4_auth()
# sheet_url <- "https://docs.google.com/spreadsheets/d/1aAwaL0fyrCGGU3QEjPA11_tnwMxmebkRY0pjNFKTF_I/edit#gid=1588788399"
# gs <- gs4_get(sheet_url)
# data <- gs4read_sheet(gs)
sheet_name <- "population distribution"
gs <- gs4_find(sheet_name)
data <- gs4read_sheet(gs)
# Create the population pyramid plot
ggplot(data, aes(x = -Female, xend = Male, y = Cohorts)) +
geom_segment(aes(x = 0, xend = -Female, yend = Cohorts), color = "Pink", size = 2) +
geom_segment(aes(x = 0, xend = Male, yend = Cohorts), color = "blue", size = 2) +
labs(x = "Population Count", y = "") +
=======
labs(x = "County", y = "Bed density per 10000 ppn") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_fill_discrete(name = "County") +
ggtitle("Distribution of Bed density per 10000 ppn by Rural Counties")+
coord_flip()+
geom_text(aes(label = `Bed density per 10000 ppn`), vjust = 0.5, hjust = 1, size = 6, color = colors[1])+
theme_hc()
fig7
kenya_rural<-kenya%>%
filter(Status=="Rural")%>%
arrange(`Bed density per 10000 ppn`)
#create bar chart
fig7<-ggplot(kenya_rural, aes(x = reorder(COUNTY, -`Bed density per 10000 ppn`), y = `Bed density per 10000 ppn`,
fill="#15616D")) +
geom_bar(stat = "identity",show.legend = FALSE) +
>>>>>>> 490b9a6f9f89b705a1eb8efc333af9d3fabab3d8
theme_minimal() +
labs(x = "County", y = "Bed density per 10000 ppn") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_fill_discrete(name = "County") +
ggtitle("Distribution of Bed density per 10000 ppn by Rural Counties")+
coord_flip()+
geom_text(aes(label = `Bed density per 10000 ppn`), vjust = 0.5, hjust = 1, size = 6, color = colors[1])+
theme_hc()
fig7
# Filter the data to include only rural counties
kenya_rural <- kenya %>%
filter(Status == "Urban") %>%
arrange(Health_LV4)
# Create the bar chart
fig2<-ggplot(kenya_rural, aes(x = reorder(COUNTY, -Health_LV4), y = Health_LV4)) +
geom_bar(stat = "identity", show.legend = FALSE,fill=colors[1]) +
theme_minimal() +
labs(x = "County", y = "Number of Level 4 Hospitals") +
scale_fill_discrete(name = "County") +
ggtitle("Distribution of Level 4 Hospitals by Urban Counties") +
coord_flip()+
geom_text(aes(label = Health_LV4), vjust = 0.5, hjust = 1, size = 8, color = colors[7])+
theme_hc()
# Filter the data to include only rural counties
kenya_rural <- kenya %>%
filter(Status == "Urban") %>%
arrange(Health_LV4)
# Create the bar chart
fig2<-ggplot(kenya_rural, aes(x = reorder(COUNTY, -Health_LV4), y = Health_LV4)) +
geom_bar(stat = "identity", show.legend = FALSE,fill=colors[1]) +
theme_minimal() +
labs(x = "County", y = "Number of Level 4 Hospitals") +
scale_fill_discrete(name = "County") +
ggtitle("Distribution of Level 4 Hospitals by Urban Counties") +
coord_flip()+
geom_text(aes(label = Health_LV4), vjust = 0.5, hjust = 1, size = 8, color = colors[7])+
theme_hc()
fig2
fig3
fig4
fig5
kenya_rural<-kenya%>%
filter(Status=="Rural")%>%
arrange(Health_LV2)
#create bar chart
fig5<-ggplot(kenya, aes(x = reorder(COUNTY, -Health_LV2), y = Health_LV2, fill = colors[1])) +
geom_bar(stat = "identity",show.legend = FALSE) +
theme_minimal() +
labs(x = "County", y = "Number of Level 2 Hospitals") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_fill_discrete(name = "County") +
ggtitle("Distribution of Level 2 Hospitals by Rural Counties")+
coord_flip()+
geom_text(aes(label = Health_LV2), vjust = 0.5, hjust = 1, size = 3, color = colors[7])+
theme_hc()
fig5
kenya_rural
kenya_rural<-kenya%>%
filter(Status=="Urban")%>%
arrange(Health_LV2)
#create bar chart
fig6<-ggplot(kenya_rural, aes(x = reorder(COUNTY, -Health_LV2), y = Health_LV2)) +
geom_bar(stat = "identity",show.legend = FALSE,fill=colors[1]) +
theme_minimal() +
labs(x = "County", y = "Number of Level 2 Hospitals") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_fill_discrete(name = "County") +
ggtitle("Distribution of Level 2 Hospitals by Urban Counties")+
coord_flip()+
geom_text(aes(label = Health_LV2), vjust = 0.5, hjust = 1, size = 6, color = colors[7])+
theme_hc()
fig6
kenya_rural
kenya
kenya_rural<-kenya%>%
filter(Status=="Urban")%>%
arrange(Health_LV2)
#create bar chart
fig6<-ggplot(kenya_rural, aes(x = reorder(COUNTY, -Health_LV2), y = Health_LV2)) +
geom_bar(stat = "identity",show.legend = FALSE,fill=colors[1]) +
theme_minimal() +
labs(x = "County", y = "Number of Level 2 Hospitals") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_fill_discrete(name = "County") +
ggtitle("Distribution of Level 2 Hospitals by Urban Counties")+
coord_flip()+
geom_text(aes(label = Health_LV2), vjust = 0.5, hjust = 1, size = 6, color = colors[7])+
theme_hc()
fig6
kenya_rural
kenya_rural<-kenya%>%
filter(Status=="Rural")%>%
arrange(Health_LV2)
#create bar chart
fig5<-ggplot(kenya_rural, aes(x = reorder(COUNTY, -Health_LV2), y = Health_LV2, fill = colors[1])) +
geom_bar(stat = "identity",show.legend = FALSE) +
theme_minimal() +
labs(x = "County", y = "Number of Level 2 Hospitals") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_fill_discrete(name = "County") +
ggtitle("Distribution of Level 2 Hospitals by Rural Counties")+
coord_flip()+
geom_text(aes(label = Health_LV2), vjust = 0.5, hjust = 1, size = 3, color = colors[7])+
theme_hc()
fig5
fig6
fig7
fig7
kenya_rural<-kenya%>%
filter(Status=="Rural")%>%
arrange(`Bed density per 10000 ppn`)
#create bar chart
fig7<-ggplot(kenya_rural, aes(x = reorder(COUNTY, -`Bed density per 10000 ppn`), y = `Bed density per 10000 ppn`,
fill="#15616D")) +
geom_bar(stat = "identity",show.legend = FALSE) +
theme_minimal() +
labs(x = "County", y = "Bed density per 10000 ppn") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_fill_discrete(name = "County") +
ggtitle("Distribution of Bed density per 10000 ppn by Rural Counties")+
coord_flip()+
geom_text(aes(label = `Bed density per 10000 ppn`), vjust = 0.5, hjust = 1, size = 3, color = colors[1])+
theme_hc()
fig7
kenya_rural<-kenya%>%
filter(Status=="Rural")%>%
arrange(`Bed density per 10000 ppn`)
#create bar chart
fig7<-ggplot(kenya_rural, aes(x = reorder(COUNTY, -`Bed density per 10000 ppn`), y = `Bed density per 10000 ppn`,
fill="#15616D")) +
geom_bar(stat = "identity",show.legend = FALSE) +
theme_minimal() +
labs(x = "County", y = "Bed density per 10000 ppn") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_fill_discrete(name = "County") +
ggtitle("Distribution of Bed density per 10000 ppn by Rural Counties")+
coord_flip()+
geom_text(aes(label = `Bed density per 10000 ppn`), vjust = 0.5, hjust = 1, size = 4, color = colors[1])+
theme_hc()
fig7
fig8
kenya_rural<-kenya%>%
filter(Status=="Urban")%>%
arrange(`Bed density per 10000 ppn`)
#create bar chart
fig8<-ggplot(kenya_rural, aes(x = reorder(COUNTY, -`Bed density per 10000 ppn`), y = `Bed density per 10000 ppn`)) +
geom_bar(stat = "identity",show.legend = FALSE,fill=colors[7]) +
theme_minimal() +
labs(x = "County", y = "Bed density per 10000 ppn") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_fill_discrete(name = "County") +
ggtitle("Distribution of Bed density per 10000 ppn by Urban Counties")+
coord_flip()+
scale_fill_manual(values = colors)+
geom_text(aes(label = `Bed density per 10000 ppn`), vjust = 0.5, hjust = 1, size = 4, color = colors[1])+
theme_hc()
fig8
kenya_rural<-kenya%>%
filter(Status=="Urban")%>%
arrange(`Bed density per 10000 ppn`)
#create bar chart
fig8<-ggplot(kenya_rural, aes(x = reorder(COUNTY, -`Bed density per 10000 ppn`), y = `Bed density per 10000 ppn`)) +
geom_bar(stat = "identity",show.legend = FALSE,fill=colors[7]) +
theme_minimal() +
<<<<<<< HEAD
scale_x_continuous(labels = abs) +
theme(legend.position = "none") +
geom_text(aes(x = 0, label = Cohorts), hjust = 0, nudge_x = -150) +
geom_text(aes(x = 0, label = Cohorts), hjust = 1, nudge_x = 150)
>>>>>>> 853f74498eb8b7e5537daefca45670297b41da9d
=======
labs(x = "County", y = "Bed density per 10000 ppn") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_fill_discrete(name = "County") +
ggtitle("Distribution of Bed density per 10000 ppn by Urban Counties")+
coord_flip()+
scale_fill_manual(values = colors)+
geom_text(aes(label = `Bed density per 10000 ppn`), vjust = 0.5, hjust = 1, size = 6, color = colors[1])+
theme_hc()
fig8
kenya_rural<-kenya%>%
filter(Status=="Rural")%>%
arrange(`Health worker per 10000 ppn`)
#create bar chart
fig9<-ggplot(kenya_rural, aes(x = reorder(COUNTY, -`Health worker per 10000 ppn`), y = `Health worker per 10000 ppn`,
fill="#15616D")) +
geom_bar(stat = "identity",show.legend = FALSE) +
theme_minimal() +
labs(x = "County", y = "Health worker per 10000 ppn") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_fill_discrete(name = "County") +
ggtitle("Distribution of Health worker per 10000 ppn by Urban Counties")+
coord_flip()+
scale_fill_manual(values = colors)+
geom_text(aes(label = `Health worker per 10000 ppn`), vjust = 0.5, hjust = 1, size = 4, color = colors[1])+
theme_hc()
fig9
kenya_rural<-kenya%>%
filter(Status=="Rural")%>%
arrange(`Health worker per 10000 ppn`)
#create bar chart
fig9<-ggplot(kenya_rural, aes(x = reorder(COUNTY, -`Health worker per 10000 ppn`), y = `Health worker per 10000 ppn`,
fill="#15616D")) +
geom_bar(stat = "identity",show.legend = FALSE) +
theme_minimal() +
labs(x = "County", y = "Health worker per 10000 ppn") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_fill_discrete(name = "County") +
ggtitle("Distribution of Health worker per 10000 ppn by Urban Counties")+
coord_flip()+
scale_fill_manual(values = colors)+
geom_text(aes(label = `Health worker per 10000 ppn`), vjust = 0.5, hjust = 1, size = 4, color = colors[7])+
theme_hc()
fig9
kenya_rural<-kenya%>%
filter(Status=="Urban")%>%
arrange(`Health worker per 10000 ppn`)
#create bar chart
fig10<-ggplot(kenya_rural, aes(x = reorder(COUNTY, -`Health worker per 10000 ppn`), y = `Health worker per 10000 ppn`)) +
geom_bar(stat = "identity",show.legend = FALSE,fill=colors[7]) +
theme_minimal() +
labs(x = "County", y = "Health worker per 10000 ppn") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_fill_discrete(name = "County") +
ggtitle("Distribution of Health worker per 10000 ppn by Urban Counties")+
coord_flip()+
scale_fill_manual(values = colors)+
geom_text(aes(label = `Health worker per 10000 ppn`), vjust = 0.5, hjust = 1, size = 4, color = colors[7])+
theme_hc()
fig10
kenya_rural<-kenya%>%
filter(Status=="Urban")%>%
arrange(`Health worker per 10000 ppn`)
#create bar chart
fig10<-ggplot(kenya_rural, aes(x = reorder(COUNTY, -`Health worker per 10000 ppn`), y = `Health worker per 10000 ppn`)) +
geom_bar(stat = "identity",show.legend = FALSE,fill=colors[7]) +
theme_minimal() +
labs(x = "County", y = "Health worker per 10000 ppn") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_fill_discrete(name = "County") +
ggtitle("Distribution of Health worker per 10000 ppn by Urban Counties")+
coord_flip()+
scale_fill_manual(values = colors)+
geom_text(aes(label = `Health worker per 10000 ppn`), vjust = 0.5, hjust = 1, size = 4, color = colors[1])+
theme_hc()
fig10
kenya_rural<-kenya%>%
filter(Status=="Urban")%>%
arrange(`Health worker per 10000 ppn`)
#create bar chart
fig10<-ggplot(kenya_rural, aes(x = reorder(COUNTY, -`Health worker per 10000 ppn`), y = `Health worker per 10000 ppn`)) +
geom_bar(stat = "identity",show.legend = FALSE,fill=colors[7]) +
theme_minimal() +
labs(x = "County", y = "Health worker per 10000 ppn") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_fill_discrete(name = "County") +
ggtitle("Distribution of Health worker per 10000 ppn by Urban Counties")+
coord_flip()+
scale_fill_manual(values = colors)+
geom_text(aes(label = `Health worker per 10000 ppn`), vjust = 0.5, hjust = 1, size = 6, color = colors[1])+
theme_hc()
fig10
>>>>>>> 6b3d9fc244cc538a469975f1290596dfd3b84555
library(gridExtra)
library(readxl)
library(reshape2)
library(janitor)
library(ggthemes)
library(leaflet)
library(dplyr)
library(sf)
library(ggplot2)
library(knitr)
# library(kableExtra)
df <- data.frame(
Details = c("Time Frame","Deadline","Software/Tools"),
values  = c("1 Week","28th September","R - studio")
)
df %>% kable(caption = "The rules of the datathon")
colors <- c('#BC5308', '#FFECD1', '#C5CAB8', '#FF7D00', '#8AA79F', '#FFB569', '#15616D', '#001524')
df <- read_excel("Dataset/Dataset.xlsx", sheet = "data")
kenya <- df
kenya1 <- df
df %>% select(1:7) %>% head() %>% knitr::kable(caption = "A sample of the data")
data<-read_excel("Dataset.xlsx",sheet="population distribution")
data$Cohorts<-as.factor(data$Cohorts)
data$Cohorts<-ifelse(data$Cohorts=="0-5","0-5",
ifelse(data$Cohorts=="45091","6-14",
ifelse(data$Cohorts=="15-35","15-35",
ifelse(data$Cohorts=="36-60","36-60","61+"))))
data$Cohorts <- factor(data$Cohorts, levels = c("0-5", "6-14", "15-35", "36-60", "61+"))
library(ggplot2)
# Create a histogram of age cohort distribution
ggplot(data, aes(x = Cohorts, y = Total)) +
geom_bar(stat = "identity", fill = '#15616D') +
# geom_text(aes(label = Total)) +
labs(x = "Age group ", y = "Population", title = "Age  Distribution for the Entire Country") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
cohort_summary <- data %>%
group_by(County,Cohorts) %>%
summarise(Total_Population = round((sum(Total)/100000),3))
# Create the bar graph
ggplot(cohort_summary, aes(x = reorder(County, -Total_Population), y = Total_Population, fill = Cohorts)) +
geom_bar(stat = "identity", position = "dodge") +
labs(x = "County", y = "Total Population '00000'", title = "Population by Cohorts Across Counties '00000'") +
scale_fill_discrete() +
theme_minimal() +
scale_fill_manual(values = colors) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
data_long <- data %>%
pivot_longer(cols = -c("County", "Cohorts", "Total"), names_to = "gender", values_to = "population")
# Calculate Total population per County
total_population <- data_long %>%
group_by(County) %>%
summarise(Total_Population = sum(population))
# Reorder the levels of County based on Total population (descending order)
data_long$County <- factor(data_long$County, levels = total_population$County[order(-total_population$Total_Population)])
data_long %>%
group_by(County, gender) %>%
summarise(Totals = round((sum(population) / 100000), 2)) %>%
ggplot(aes(x = County, y = Totals, fill = gender)) +
geom_bar(stat = "identity") +
geom_text(aes(label = Totals), position = position_stack(vjust = 0.5), size = 3) +
labs(y = "Population '00000'", x = "County", title = "Gender Distribution by County in '00000'") +
scale_fill_manual(values = c("Female" = '#FFECD1', "Male" = '#15616D')) +
theme_minimal() +
coord_flip() +
theme(axis.text.x = element_text(angle = 45, hjust = 0.5))
# Assuming you have already loaded and transformed your data into 'data_long' as described in your code
data_long %>%
group_by( Cohorts, gender) %>%
summarise(Totals = round((sum(population) / 100000), 2)) %>%
ggplot(aes(x = Cohorts, y = Totals, fill = gender)) +
geom_bar(stat = "identity", position = "dodge") +
geom_text(aes(label = Totals), position = position_dodge(width = 0.9), size = 3, vjust = -0.5) +
labs(y = "Population", x = "Age groups", title = "Gender Distribution by  Age Group in '00000'") +
scale_fill_manual(values = c("Female" = '#FFECD1', "Male" = '#15616D')) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 0.5))
stats=df %>% summarise(`Rural mean population`=mean(Rural_ppn),
`Rural SD`=sd(Rural_ppn),
`Rural IQR`=IQR(Rural_ppn),
`Urban mean population`=mean(Urban_ppn),
`Urban SD`=sd(Urban_ppn),
`Urban IQR`=IQR(Urban_ppn))
stats %>% kable()
DataRural=df %>%
select(County, Rural_ppn, Urban_ppn) %>%
pivot_longer(cols = c(Rural_ppn, Urban_ppn), names_to = "Residence", values_to = "Populations") %>%
DataRural=df %>%
select(County, Rural_ppn, Urban_ppn) %>%
pivot_longer(cols = c(Rural_ppn, Urban_ppn), names_to = "Residence", values_to = "Populations")
DataRural=df %>%
select(County, Rural_ppn, Urban_ppn) %>%
pivot_longer(cols = c(Rural_ppn, Urban_ppn), names_to = "Residence", values_to = "Populations")
DataRural$Residence=DataRural$Residence %>%  ifelse(DataRural$Residence="Rural_ppn","Rural","Urban")
DataRural=df %>%
select(County, Rural_ppn, Urban_ppn) %>%
pivot_longer(cols = c(Rural_ppn, Urban_ppn), names_to = "Residence", values_to = "Populations")
DataRural$Residence= ifelse(DataRural$Residence="Rural_ppn","Rural","Urban")
DataRural=df %>%
select(County, Rural_ppn, Urban_ppn) %>%
pivot_longer(cols = c(Rural_ppn, Urban_ppn), names_to = "Residence", values_to = "Populations")
DataRural$Residence= ifelse(DataRural$Residence=="Rural_ppn","Rural","Urban")
DataRural$Residence
DataRural
DataRural=df %>%
select(County, Rural_ppn, Urban_ppn) %>%
pivot_longer(cols = c(Rural_ppn, Urban_ppn), names_to = "Residence", values_to = "Populations")
DataRural$Residence= ifelse(DataRural$Residence=="Rural_ppn","Rural","Urban")
# Calculate Total population per County
total_population <- DataRural %>%
group_by(County) %>%
summarise(Total_Population = sum(populations))
total_population <- DataRural %>%
group_by(County) %>%
summarise(Total_Population = sum(populations))
DataRural
DataRural %>%
group_by(County)
DataRural %>%
group_by(County) %>%
summarise(Total_Population = sum(populations))
DataRural$Populations<-as.numeric(DataRural$Populations)
total_population <- DataRural %>%
group_by(County) %>%
summarise(Total_Population = sum(populations))
DataRural %>%
group_by(County) %>%
summarise(Total_Population = sum(populations))
DataRural %>%
group_by(County, Residence) %>%
summarise(Totals = round((sum(Populations) / 100000), 2)) %>%
ggplot(aes(x = County, y = Totals, fill = Residence)) +
geom_bar(stat = "identity") +
geom_text(aes(label = Totals), position = position_stack(vjust = 0.5), size = 3) +
labs(y = "Population '00000'", x = "County", title = "Population of residence Distribution by County in '00000'") +
scale_fill_manual(values = c("Rural" = '#FFECD1', "Urban" = '#15616D')) +
theme_minimal() +
coord_flip() +
theme(axis.text.x = element_text(angle = 45, hjust = 0.5))
DataRural=df %>%
select(County, Rural_ppn, Urban_ppn) %>%
pivot_longer(cols = c(Rural_ppn, Urban_ppn), names_to = "Residence", values_to = "Populations")
DataRural$Residence= ifelse(DataRural$Residence=="Rural_ppn","Rural","Urban")
DataRural$Populations<-as.numeric(DataRural$Populations)
# Calculate Total population per County
total_population <- DataRural %>%
group_by(County) %>%
summarise(Total_Population = sum(populations))
DataRural %>%
group_by(County) %>%
summarise(Total_Population = sum(populations))
DataRural <- df %>%
select(County, Rural_ppn, Urban_ppn) %>%
pivot_longer(cols = c(Rural_ppn, Urban_ppn), names_to = "Residence", values_to = "Populations")
DataRural$Residence <- ifelse(DataRural$Residence == "Rural_ppn", "Rural", "Urban")
DataRural$Populations <- as.numeric(DataRural$Populations)
# Calculate Total population per County
total_population <- DataRural %>%
group_by(County) %>%
summarise(Total_Population = sum(Populations))
# Reorder the levels of County based on Total population (descending order)
DataRural$County <- factor(DataRural$County, levels = total_population$County[order(-total_population$Total_Population)])
DataRural %>%
group_by(County, Residence) %>%
summarise(Totals = round((sum(Populations) / 100000), 2)) %>%
ggplot(aes(x = County, y = Totals, fill = Residence)) +
geom_bar(stat = "identity") +
geom_text(aes(label = Totals), position = position_stack(vjust = 0.5), size = 3) +
labs(y = "Population '00000'", x = "County", title = "Population of Residence Distribution by County in '00000'") +
scale_fill_manual(values = c("Rural" = '#FFECD1', "Urban" = '#15616D')) +
theme_minimal() +
coord_flip() +
theme(axis.text.x = element_text(angle = 45, hjust = 0.5))
DataRural <- df %>%
select(County, Rural_ppn, Urban_ppn) %>%
pivot_longer(cols = c(Rural_ppn, Urban_ppn), names_to = "Residence", values_to = "Populations")
DataRural$Residence <- ifelse(DataRural$Residence == "Rural_ppn", "Rural", "Urban")
DataRural$Populations <- as.numeric(DataRural$Populations)
# Calculate Total population per County
total_population <- DataRural %>%
group_by(County) %>%
summarise(Total_Population = sum(Populations))
# Reorder the levels of County based on Total population (descending order)
DataRural$County <- factor(DataRural$County, levels = total_population$County[order(total_population$Total_Population)])
DataRural %>%
group_by(County, Residence) %>%
summarise(Totals = round((sum(Populations) / 100000), 2)) %>%
ggplot(aes(x = County, y = Totals, fill = Residence)) +
geom_bar(stat = "identity") +
geom_text(aes(label = Totals), position = position_stack(vjust = 0.5), size = 3) +
labs(y = "Population '00000'", x = "County", title = "Population of Residence Distribution by County in '00000'") +
scale_fill_manual(values = c("Rural" = '#FFECD1', "Urban" = '#15616D')) +
theme_minimal() +
coord_flip() +
theme(axis.text.x = element_text(angle = 45, hjust = 0.5))
# Load the shapefile
kenya_counties <- st_read("LYNN ANALYSIS/County.shp")
# Merge data by county
merged_data <- merge(kenya_counties, kenya, by.x = "COUNTY", by.y = "COUNTY")
kenya_counties
# Create a leaflet map
#install.packages("leaflet")
#remotes::install_github("rstudio/webshot2")
library(leaflet)
library(webshot2)
kenya_map <- leaflet(merged_data) %>%
addProviderTiles("CartoDB.Positron") %>%
addPolygons(
fillColor = ~colorQuantile("YlOrRd", merged_data$`Total Population`)(merged_data$`Total Population`),
fillOpacity = 0.7,
color = "white",
weight = 1,
label = ~paste(merged_data$COUNTY, "<br>", "Total Population:", merged_data$`Total Population`, "people"),
highlight = highlightOptions(
weight = 3,
color = "#666",
fillOpacity = 0.7,
bringToFront = TRUE
),
labelOptions = labelOptions(
style = list("font-weight" = "normal", padding = "3px 8px"),
textsize = "15px"
)
) %>%
addLegend(
"bottomright",
pal = colorQuantile("YlOrRd", merged_data$`Total Population`),
values = ~merged_data$`Total Population`,
title = "Total population",
opacity = 0.7
)
# Display the map
htmlwidgets::saveWidget(kenya_map, "kenya_map.html")
# Take a screenshot and save it as an image
webshot2::webshot("kenya_map.html", "kenya_map.png")
data<-read_excel("Dataset.xlsx",sheet="population distribution")
data$Cohorts<-as.factor(data$Cohorts)
data$Cohorts<-ifelse(data$Cohorts=="0-5","0-5",
ifelse(data$Cohorts=="45091","6-14",
ifelse(data$Cohorts=="15-35","15-35",
ifelse(data$Cohorts=="36-60","36-60","61+"))))
data$Cohorts <- factor(data$Cohorts, levels = c("0-5", "6-14", "15-35", "36-60", "61+"))
library(ggplot2)
# Create a histogram of age cohort distribution
ggplot(data, aes(x = Cohorts, y = Total)) +
geom_bar(stat = "identity", fill = '#15616D') +
geom_text(aes(label = Total), vjust = -0.5, size = 3) +  # Add text labels above the bars
labs(x = "Age group", y = "Population", title = "Age Distribution for the Entire Country") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
data<-read_excel("Dataset.xlsx",sheet="population distribution")
data$Cohorts<-as.factor(data$Cohorts)
data$Cohorts<-ifelse(data$Cohorts=="0-5","0-5",
ifelse(data$Cohorts=="45091","6-14",
ifelse(data$Cohorts=="15-35","15-35",
ifelse(data$Cohorts=="36-60","36-60","61+"))))
data$Cohorts <- factor(data$Cohorts, levels = c("0-5", "6-14", "15-35", "36-60", "61+"))
library(ggplot2)
# Create a histogram of age cohort distribution
data %>%
group_by(Cohorts) %>% summarise(Totals=sum(Total))
ggplot( aes(x = Cohorts, y = Totals)) +
geom_bar(stat = "identity", fill = '#15616D') +
geom_text(aes(label = "Totals"), vjust = -0.5, size = 3) +  # Add text labels above the bars
labs(x = "Age group", y = "Population", title = "Age Distribution for the Entire Country") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
data<-read_excel("Dataset.xlsx",sheet="population distribution")
data$Cohorts<-as.factor(data$Cohorts)
data$Cohorts<-ifelse(data$Cohorts=="0-5","0-5",
ifelse(data$Cohorts=="45091","6-14",
ifelse(data$Cohorts=="15-35","15-35",
ifelse(data$Cohorts=="36-60","36-60","61+"))))
data$Cohorts <- factor(data$Cohorts, levels = c("0-5", "6-14", "15-35", "36-60", "61+"))
library(ggplot2)
# Create a histogram of age cohort distribution
data %>%
group_by(Cohorts) %>% summarise(Totals=sum(Total))
ggplot( aes(x = Cohorts, y = Totals)) +
geom_bar(stat = "identity", fill = '#15616D') +
geom_text(aes(label = Totals), vjust = -0.5, size = 3) +  # Add text labels above the bars
labs(x = "Age group", y = "Population", title = "Age Distribution for the Entire Country") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
data<-read_excel("Dataset.xlsx",sheet="population distribution")
data$Cohorts<-as.factor(data$Cohorts)
data$Cohorts<-ifelse(data$Cohorts=="0-5","0-5",
ifelse(data$Cohorts=="45091","6-14",
ifelse(data$Cohorts=="15-35","15-35",
ifelse(data$Cohorts=="36-60","36-60","61+"))))
data$Cohorts <- factor(data$Cohorts, levels = c("0-5", "6-14", "15-35", "36-60", "61+"))
library(ggplot2)
# Create a histogram of age cohort distribution
data %>%
group_by(Cohorts) %>%
summarise(Totals=sum(Total)) %>%
ggplot( aes(x = Cohorts, y = Totals)) +
geom_bar(stat = "identity", fill = '#15616D') +
geom_text(aes(label = Totals), vjust = -0.5, size = 3) +  # Add text labels above the bars
labs(x = "Age group", y = "Population", title = "Age Distribution for the Entire Country") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
data<-read_excel("Dataset.xlsx",sheet="population distribution")
data$Cohorts<-as.factor(data$Cohorts)
data$Cohorts<-ifelse(data$Cohorts=="0-5","0-5",
ifelse(data$Cohorts=="45091","6-14",
ifelse(data$Cohorts=="15-35","15-35",
ifelse(data$Cohorts=="36-60","36-60","61+"))))
data$Cohorts <- factor(data$Cohorts, levels = c("0-5", "6-14", "15-35", "36-60", "61+"))
library(ggplot2)
# Create a histogram of age cohort distribution
data %>%
group_by(Cohorts) %>%
summarise(Totals=sum(Total)) %>%
ggplot( aes(x = Cohorts, y = Totals)) +
geom_bar(stat = "identity", fill = '#15616D') +
geom_text(aes(label = Totals), vjust = -0.5, size = 3) +  # Add text labels above the bars
labs(x = "Age group", y = "Total population", title = "Age Distribution for the Entire Country") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
cohort_summary <- data %>%
group_by(County,Cohorts) %>%
summarise(Total_Population = round((sum(Total)/100000),3))
# Create the bar graph
ggplot(cohort_summary, aes(x = reorder(County, -Total_Population), y = Total_Population, fill = Cohorts)) +
geom_bar(stat = "identity", position = "dodge") +
labs(x = "County", y = "Total Population '00000'", title = "Population by Cohorts Across Counties '00000'") +
scale_fill_discrete() +
theme_minimal() +
scale_fill_manual(values = colors) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
# Assuming you have already loaded and transformed your data into 'data_long' as described in your code
data_long %>%
group_by( Cohorts, gender) %>%
summarise(Totals = round((sum(population) / 100000), 2)) %>%
ggplot(aes(x = Cohorts, y = Totals, fill = gender)) +
geom_bar(stat = "identity", position = "dodge") +
geom_text(aes(label = Totals), position = position_dodge(width = 0.9), size = 3, vjust = -0.5) +
labs(y = "Population", x = "Age groups", title = "Gender Distribution by  Age Group in '00000'") +
scale_fill_manual(values = c("Female" = '#FFECD1', "Male" = '#15616D')) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 0.5))
knitr::opts_chunk$set(echo = TRUE,warning =F,message = F,comment = NA)
colors <- c('#BC5308', '#FFECD1', '#C5CAB8', '#FF7D00', '#8AA79F', '#FFB569', '#15616D', '#001524')
df <- read_excel("Dataset/Dataset.xlsx", sheet = "data")
kenya <- df
kenya1 <- df
df %>% select(1:7) %>% head() %>% knitr::kable(caption = "A sample of the data")
